#Open Elections

files = os.listdir("./raw-from-source/Election_Results/")
li = []
for file in files:
    if "20161108" in file: 
        file_string = "./raw-from-source/Election_Results/" + file
        df = pd.read_csv(file_string)
        df = df.drop(['office','district','party'], axis=1)
        df = df.pivot_table(index = ['county','precinct'], columns = 'candidate', values = 'votes').reset_index()
        df.index.name = df.columns.name = None
        
        columns = ['county','precinct','Donald J. Trump','Hillary Clinton','Gary Johnson','Darrell L. Castle','John R. Thune','Jay Williams','Kristi Noem','Paula Hawks','Chris Nelson','Henry Red Cloud']
# #         df = df[['Donald J. Trump','Hillary Clinton', 'Gary Johnson','Darrell L. Castle','John R. Thune','Jay Williams','Kristi Noem','Paula Hawks','Chris Nelson','Henry Red Cloud']]
        df = df.reindex(columns = columns)
        # Remove the rows with column names and rows with total votes
        df = df[df["precinct"]!="Total"]
        df = df[df["precinct"]!="TOTAL"]
        li.append(df)
final = pd.concat(li)

# # Deal with the index
final.reset_index(drop=True,inplace=True)

# Using the provided file

df = pd.read_csv("./raw-from-source/Election_Results/precinct_all.csv")
df = df.drop(['office','district','party'], axis=1)
df = df.pivot_table(index = ['county','precinct'], columns = 'candidate', values = 'votes').reset_index()
df.index.name = df.columns.name = None

columns = ['county','precinct','Donald J. Trump','Hillary Clinton','Gary Johnson','Darrell L. Castle','John R. Thune','Jay Williams','Kristi Noem','Paula Hawks','Chris Nelson','Henry Red Cloud']
# df = df[['Donald J. Trump','Hillary Clinton', 'Gary Johnson','Darrell L. Castle','John R. Thune','Jay Williams','Kristi Noem','Paula Hawks','Chris Nelson','Henry Red Cloud']]
df = df.reindex(columns = columns)

df = df[df["precinct"]!="Total"]
df = df[df["precinct"]!="TOTAL"]

df.reset_index(drop=True,inplace=True)
df